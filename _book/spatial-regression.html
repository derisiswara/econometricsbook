<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Spatial Regression | Application of Econometric Models with RStudio</title>
<meta name="author" content="Deri Siswara">
<meta name="description" content='6.1 Library # install.packages("spdep") # install.packages("spatialreg") # install.packages("RColorBrewer") # install.packages("splm") # install.packages("sf") # install.packages("ggplot2")...'>
<meta name="generator" content="bookdown 0.38 with bs4_book()">
<meta property="og:title" content="Chapter 6 Spatial Regression | Application of Econometric Models with RStudio">
<meta property="og:type" content="book">
<meta property="og:description" content='6.1 Library # install.packages("spdep") # install.packages("spatialreg") # install.packages("RColorBrewer") # install.packages("splm") # install.packages("sf") # install.packages("ggplot2")...'>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Spatial Regression | Application of Econometric Models with RStudio">
<meta name="twitter:description" content='6.1 Library # install.packages("spdep") # install.packages("spatialreg") # install.packages("RColorBrewer") # install.packages("splm") # install.packages("sf") # install.packages("ggplot2")...'>
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Application of Econometric Models with RStudio</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="basics-of-r.html"><span class="header-section-number">1</span> Basics of R</a></li>
<li><a class="" href="basic-linear-regression.html"><span class="header-section-number">2</span> Basic Linear Regression</a></li>
<li><a class="" href="univariate-time-series.html"><span class="header-section-number">3</span> Univariate Time Series</a></li>
<li><a class="" href="multivariate-time-series.html"><span class="header-section-number">4</span> Multivariate Time Series</a></li>
<li><a class="" href="panel-data-regression.html"><span class="header-section-number">5</span> Panel Data Regression</a></li>
<li><a class="active" href="spatial-regression.html"><span class="header-section-number">6</span> Spatial Regression</a></li>
<li><a class="" href="time-series-spillover---gvar.html"><span class="header-section-number">7</span> Time Series Spillover - GVAR</a></li>
<li><a class="" href="multivariate-garch.html"><span class="header-section-number">8</span> Multivariate GARCH</a></li>
<li><a class="" href="nardl.html"><span class="header-section-number">9</span> NARDL</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/dekayzds/ds-econometrics">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="spatial-regression" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Spatial Regression<a class="anchor" aria-label="anchor" href="#spatial-regression"><i class="fas fa-link"></i></a>
</h1>
<div id="library" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Library<a class="anchor" aria-label="anchor" href="#library"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("spdep")</span></span>
<span><span class="co"># install.packages("spatialreg")</span></span>
<span><span class="co"># install.packages("RColorBrewer")</span></span>
<span><span class="co"># install.packages("splm")</span></span>
<span><span class="co"># install.packages("sf")</span></span>
<span><span class="co"># install.packages("ggplot2")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/">spdep</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'spdep' was built under R version 4.2.3</span></span>
<span><span class="co">#&gt; Loading required package: spData</span></span>
<span><span class="co">#&gt; Warning: package 'spData' was built under R version 4.2.3</span></span>
<span><span class="co">#&gt; To access larger datasets in this package, install</span></span>
<span><span class="co">#&gt; the spDataLarge package with:</span></span>
<span><span class="co">#&gt; `install.packages('spDataLarge',</span></span>
<span><span class="co">#&gt; repos='https://nowosad.github.io/drat/',</span></span>
<span><span class="co">#&gt; type='source')`</span></span>
<span><span class="co">#&gt; Loading required package: sf</span></span>
<span><span class="co">#&gt; Warning: package 'sf' was built under R version 4.2.3</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.9.3, GDAL 3.5.2, PROJ 8.2.1; sf_use_s2()</span></span>
<span><span class="co">#&gt; is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spatialreg/">spatialreg</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'spatialreg' was built under R version</span></span>
<span><span class="co">#&gt; 4.2.3</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Warning: package 'Matrix' was built under R version 4.2.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'spatialreg'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:spdep':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     get.ClusterOption, get.coresOption, get.mcOption,</span></span>
<span><span class="co">#&gt;     get.VerboseOption, get.ZeroPolicyOption,</span></span>
<span><span class="co">#&gt;     set.ClusterOption, set.coresOption, set.mcOption,</span></span>
<span><span class="co">#&gt;     set.VerboseOption, set.ZeroPolicyOption</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">splm</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'splm' was built under R version 4.2.3</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.2.3</span></span></code></pre></div>
</div>
<div id="cross-section" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Cross-Section<a class="anchor" aria-label="anchor" href="#cross-section"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'readxl' was built under R version 4.2.3</span></span>
<span><span class="va">provinsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/Bab6/provinsi Indonesia.xlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">provinsi</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   province    pdrb investment infra revenue</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Aceh     129093.      4485.  0.37  11694.</span></span>
<span><span class="co">#&gt; 2 Sumut    571722.     21477.  0.52   8481.</span></span>
<span><span class="co">#&gt; 3 Sumbar   179952.      2340.  0.52   4052.</span></span>
<span><span class="co">#&gt; 4 Riau     652762.     18957.  0.28   6911.</span></span>
<span><span class="co">#&gt; 5 Jambi    155066.      5026.  0.26   3130.</span></span>
<span><span class="co">#&gt; 6 Sumsel   331766.     19853.  0.2    5990.</span></span></code></pre></div>
<div id="ols-model" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> OLS Model<a class="anchor" aria-label="anchor" href="#ols-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pdrb</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">investment</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">infra</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">revenue</span><span class="op">)</span></span>
<span><span class="va">ols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">model1</span>, data<span class="op">=</span><span class="va">provinsi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">ols</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = model1, data = provinsi)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.82306 -0.33812  0.00604  0.32399  0.83581 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)      3.95883    0.85379   4.637 6.48e-05 ***</span></span>
<span><span class="co">#&gt; log(investment)  0.42187    0.08375   5.037 2.10e-05 ***</span></span>
<span><span class="co">#&gt; log(infra)       0.24988    0.07807   3.201  0.00323 ** </span></span>
<span><span class="co">#&gt; log(revenue)     0.53807    0.15207   3.538  0.00133 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.4094 on 30 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8883, Adjusted R-squared:  0.8771 </span></span>
<span><span class="co">#&gt; F-statistic: 79.53 on 3 and 30 DF,  p-value: 2.226e-14</span></span></code></pre></div>
</div>
<div id="weight-matrix" class="section level3" number="6.2.2">
<h3>
<span class="header-section-number">6.2.2</span> Weight Matrix<a class="anchor" aria-label="anchor" href="#weight-matrix"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">migrasi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/Bab6/matriks migrasi.xlsx"</span>, sheet <span class="op">=</span> <span class="fl">2</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; • `` -&gt; `...1`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...2`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...3`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...4`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...5`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...6`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...7`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...8`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...9`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...10`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...11`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...12`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...13`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...14`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...15`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...16`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...17`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...18`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...19`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...20`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...21`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...22`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...23`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...24`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...25`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...26`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...27`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...28`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...29`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...30`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...31`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...32`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...33`</span></span>
<span><span class="co">#&gt; • `` -&gt; `...34`</span></span>
<span><span class="va">migrasi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">migrasi</span><span class="op">)</span></span>
<span><span class="va">W.migrasi</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html">mat2listw</a></span><span class="op">(</span><span class="va">migrasi</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in mat2listw(migrasi): style is M (missing); style</span></span>
<span><span class="co">#&gt; should be set to a valid value</span></span></code></pre></div>
</div>
<div id="moran-test-and-plot" class="section level3" number="6.2.3">
<h3>
<span class="header-section-number">6.2.3</span> Moran Test and Plot<a class="anchor" aria-label="anchor" href="#moran-test-and-plot"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moran.lm</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.morantest.html">lm.morantest</a></span><span class="op">(</span><span class="va">ols</span>, <span class="va">W.migrasi</span><span class="op">)</span></span>
<span><span class="va">moran.lm</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Global Moran I for regression residuals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; model: lm(formula = model1, data = provinsi)</span></span>
<span><span class="co">#&gt; weights: W.migrasi</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Moran I statistic standard deviate = 3.4669, p-value</span></span>
<span><span class="co">#&gt; = 0.0002632</span></span>
<span><span class="co">#&gt; alternative hypothesis: greater</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; Observed Moran I      Expectation         Variance </span></span>
<span><span class="co">#&gt;      0.213239417     -0.048308437      0.005691365</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.plot.html">moran.plot</a></span><span class="op">(</span><span class="va">ols</span><span class="op">$</span><span class="va">residuals</span>, <span class="va">W.migrasi</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Bab6_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
</div>
<div id="lm-test" class="section level3" number="6.2.4">
<h3>
<span class="header-section-number">6.2.4</span> LM Test<a class="anchor" aria-label="anchor" href="#lm-test"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LM</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.RStests.html">lm.LMtests</a></span><span class="op">(</span><span class="va">ols</span>, <span class="va">W.migrasi</span>, test<span class="op">=</span><span class="st">"all"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Please update scripts to use lm.RStests in place of lm.LMtests</span></span>
<span><span class="co">#&gt; Warning in lm.RStests(model = model, listw = listw,</span></span>
<span><span class="co">#&gt; zero.policy = zero.policy, : Spatial weights matrix not row</span></span>
<span><span class="co">#&gt; standardized</span></span>
<span><span class="va">LM</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Rao's score (a.k.a Lagrange multiplier) diagnostics</span></span>
<span><span class="co">#&gt;  for spatial dependence</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; model: lm(formula = model1, data = provinsi)</span></span>
<span><span class="co">#&gt; test weights: listw</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; RSerr = 5.4456, df = 1, p-value = 0.01962</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Rao's score (a.k.a Lagrange multiplier) diagnostics</span></span>
<span><span class="co">#&gt;  for spatial dependence</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; model: lm(formula = model1, data = provinsi)</span></span>
<span><span class="co">#&gt; test weights: listw</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; RSlag = 3.2163, df = 1, p-value = 0.07291</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Rao's score (a.k.a Lagrange multiplier) diagnostics</span></span>
<span><span class="co">#&gt;  for spatial dependence</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; model: lm(formula = model1, data = provinsi)</span></span>
<span><span class="co">#&gt; test weights: listw</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; adjRSerr = 3.0702, df = 1, p-value = 0.07974</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Rao's score (a.k.a Lagrange multiplier) diagnostics</span></span>
<span><span class="co">#&gt;  for spatial dependence</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; model: lm(formula = model1, data = provinsi)</span></span>
<span><span class="co">#&gt; test weights: listw</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; adjRSlag = 0.84087, df = 1, p-value = 0.3591</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Rao's score (a.k.a Lagrange multiplier) diagnostics</span></span>
<span><span class="co">#&gt;  for spatial dependence</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; model: lm(formula = model1, data = provinsi)</span></span>
<span><span class="co">#&gt; test weights: listw</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SARMA = 6.2865, df = 2, p-value = 0.04314</span></span></code></pre></div>
</div>
<div id="sar-model" class="section level3" number="6.2.5">
<h3>
<span class="header-section-number">6.2.5</span> SAR Model<a class="anchor" aria-label="anchor" href="#sar-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sar.provinsi</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spatialreg/reference/ML_models.html">lagsarlm</a></span><span class="op">(</span><span class="va">model1</span>, data<span class="op">=</span><span class="va">provinsi</span>, <span class="va">W.migrasi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">sar.provinsi</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lagsarlm(formula = model1, data = provinsi, listw = W.migrasi)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">#&gt; -0.679482 -0.291161 -0.083437  0.336403  0.808845 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type: lag </span></span>
<span><span class="co">#&gt; Coefficients: (asymptotic standard errors) </span></span>
<span><span class="co">#&gt;                 Estimate Std. Error z value  Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)     1.744150   1.437574  1.2133 0.2250310</span></span>
<span><span class="co">#&gt; log(investment) 0.380784   0.079364  4.7979 1.603e-06</span></span>
<span><span class="co">#&gt; log(infra)      0.207431   0.073675  2.8155 0.0048701</span></span>
<span><span class="co">#&gt; log(revenue)    0.529174   0.136397  3.8797 0.0001046</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rho: 0.21114, LR test value: 3.0033, p-value: 0.083096</span></span>
<span><span class="co">#&gt; Asymptotic standard error: 0.12002</span></span>
<span><span class="co">#&gt;     z-value: 1.7592, p-value: 0.07854</span></span>
<span><span class="co">#&gt; Wald statistic: 3.0949, p-value: 0.07854</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Log likelihood: -14.24739 for lag model</span></span>
<span><span class="co">#&gt; ML residual variance (sigma squared): 0.13454, (sigma: 0.36679)</span></span>
<span><span class="co">#&gt; Number of observations: 34 </span></span>
<span><span class="co">#&gt; Number of parameters estimated: 6 </span></span>
<span><span class="co">#&gt; AIC: 40.495, (AIC for lm: 41.498)</span></span>
<span><span class="co">#&gt; LM test for residual autocorrelation</span></span>
<span><span class="co">#&gt; test value: 2.5558, p-value: 0.10989</span></span></code></pre></div>
</div>
<div id="impacts-spillover" class="section level3" number="6.2.6">
<h3>
<span class="header-section-number">6.2.6</span> Impacts (Spillover)<a class="anchor" aria-label="anchor" href="#impacts-spillover"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/spatialreg/reference/impacts.html">impacts</a></span><span class="op">(</span><span class="va">sar.provinsi</span>, listw<span class="op">=</span><span class="va">W.migrasi</span><span class="op">)</span></span>
<span><span class="co">#&gt; Impact measures (lag, exact):</span></span>
<span><span class="co">#&gt;                    Direct   Indirect     Total</span></span>
<span><span class="co">#&gt; log(investment) 0.3831961 0.09950271 0.4826988</span></span>
<span><span class="co">#&gt; log(infra)      0.2087457 0.05420401 0.2629497</span></span>
<span><span class="co">#&gt; log(revenue)    0.5325268 0.13827873 0.6708055</span></span></code></pre></div>
</div>
<div id="sem-model" class="section level3" number="6.2.7">
<h3>
<span class="header-section-number">6.2.7</span> SEM Model<a class="anchor" aria-label="anchor" href="#sem-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sem.provinsi</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spatialreg/reference/ML_models.html">errorsarlm</a></span><span class="op">(</span><span class="va">model1</span>, data<span class="op">=</span><span class="va">provinsi</span>, <span class="va">W.migrasi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">sem.provinsi</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; errorsarlm(formula = model1, data = provinsi, listw = W.migrasi)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co">#&gt; -0.770148 -0.273480 -0.020662  0.325690  0.647156 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type: error </span></span>
<span><span class="co">#&gt; Coefficients: (asymptotic standard errors) </span></span>
<span><span class="co">#&gt;                 Estimate Std. Error z value  Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)     3.831947   0.772493  4.9605 7.031e-07</span></span>
<span><span class="co">#&gt; log(investment) 0.410266   0.072801  5.6354 1.746e-08</span></span>
<span><span class="co">#&gt; log(infra)      0.209178   0.071237  2.9364  0.003321</span></span>
<span><span class="co">#&gt; log(revenue)    0.550807   0.132071  4.1705 3.039e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lambda: 0.60794, LR test value: 5.1345, p-value: 0.023455</span></span>
<span><span class="co">#&gt; Asymptotic standard error: 0.19219</span></span>
<span><span class="co">#&gt;     z-value: 3.1632, p-value: 0.0015604</span></span>
<span><span class="co">#&gt; Wald statistic: 10.006, p-value: 0.0015604</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Log likelihood: -13.18178 for error model</span></span>
<span><span class="co">#&gt; ML residual variance (sigma squared): 0.11956, (sigma: 0.34577)</span></span>
<span><span class="co">#&gt; Number of observations: 34 </span></span>
<span><span class="co">#&gt; Number of parameters estimated: 6 </span></span>
<span><span class="co">#&gt; AIC: 38.364, (AIC for lm: 41.498)</span></span></code></pre></div>
</div>
</div>
<div id="spatial-panel" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Spatial Panel<a class="anchor" aria-label="anchor" href="#spatial-panel"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="va">paneljateng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/Bab6/panel jateng.xlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">paneljateng</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 8</span></span>
<span><span class="co">#&gt;   Region       Tahun   PDRB     AK    PAD    UMK   IPM NO   </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 Kab. Cilacap  2011 7.82e7 797518 1.73e5 7.19e5  64.7 01   </span></span>
<span><span class="co">#&gt; 2 Kab. Cilacap  2012 7.97e7 716465 1.97e5 7.73e5  65.7 01   </span></span>
<span><span class="co">#&gt; 3 Kab. Cilacap  2013 8.10e7 729059 2.79e5 8.88e5  66.8 01   </span></span>
<span><span class="co">#&gt; 4 Kab. Cilacap  2014 8.34e7 736247 3.74e5 1.02e6  67.2 01   </span></span>
<span><span class="co">#&gt; 5 Kab. Cilacap  2015 8.88e7 715819 4.10e5 1.20e6  67.8 01   </span></span>
<span><span class="co">#&gt; 6 Kab. Banyum…  2011 2.45e7 761034 1.93e5 7.5 e5  67.4 02</span></span></code></pre></div>
<div id="static-panel-regression" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> Static Panel Regression<a class="anchor" aria-label="anchor" href="#static-panel-regression"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=plm">plm</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'plm' was built under R version 4.2.3</span></span>
<span><span class="va">modelpanel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">PDRB</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">AK</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">PAD</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">UMK</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">IPM</span><span class="op">)</span></span>
<span><span class="va">fem1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span><span class="va">modelpanel</span>, data<span class="op">=</span><span class="va">paneljateng</span>, index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Region"</span>, <span class="st">"Tahun"</span><span class="op">)</span>, model<span class="op">=</span><span class="st">"within"</span><span class="op">)</span></span>
<span><span class="va">rem1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span><span class="va">modelpanel</span>, data<span class="op">=</span><span class="va">paneljateng</span>, index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Region"</span>, <span class="st">"Tahun"</span><span class="op">)</span>, model<span class="op">=</span><span class="st">"random"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/phtest.html">phtest</a></span><span class="op">(</span><span class="va">fem1</span>, <span class="va">rem1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Hausman Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  modelpanel</span></span>
<span><span class="co">#&gt; chisq = 37.156, df = 4, p-value = 1.673e-07</span></span>
<span><span class="co">#&gt; alternative hypothesis: one model is inconsistent</span></span></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: zoo</span></span>
<span><span class="co">#&gt; Warning: package 'zoo' was built under R version 4.2.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'zoo'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     as.Date, as.Date.numeric</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">fem1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  studentized Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fem1</span></span>
<span><span class="co">#&gt; BP = 5.8081, df = 4, p-value = 0.2139</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pbgtest.html">pbgtest</a></span><span class="op">(</span><span class="va">fem1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch-Godfrey/Wooldridge test for serial</span></span>
<span><span class="co">#&gt;  correlation in panel models</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  modelpanel</span></span>
<span><span class="co">#&gt; chisq = 51.619, df = 5, p-value = 6.458e-10</span></span>
<span><span class="co">#&gt; alternative hypothesis: serial correlation in idiosyncratic errors</span></span></code></pre></div>
</div>
<div id="depndency-test" class="section level3" number="6.3.2">
<h3>
<span class="header-section-number">6.3.2</span> Depndency Test<a class="anchor" aria-label="anchor" href="#depndency-test"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pcdtest.html">pcdtest</a></span><span class="op">(</span><span class="va">fem1</span>, test<span class="op">=</span><span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch-Pagan LM test for cross-sectional dependence</span></span>
<span><span class="co">#&gt;  in panels</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  log(PDRB) ~ log(AK) + log(PAD) + log(UMK) + log(IPM)</span></span>
<span><span class="co">#&gt; chisq = 1268.3, df = 595, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: cross-sectional dependence</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pcdtest.html">pcdtest</a></span><span class="op">(</span><span class="va">fem1</span>, test<span class="op">=</span><span class="st">"cd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pesaran CD test for cross-sectional dependence in</span></span>
<span><span class="co">#&gt;  panels</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  log(PDRB) ~ log(AK) + log(PAD) + log(UMK) + log(IPM)</span></span>
<span><span class="co">#&gt; z = 12.724, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: cross-sectional dependence</span></span></code></pre></div>
</div>
<div id="maps-visualization" class="section level3" number="6.3.3">
<h3>
<span class="header-section-number">6.3.3</span> Maps Visualization<a class="anchor" aria-label="anchor" href="#maps-visualization"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jateng.map</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">'Data/Bab6/peta jateng/Jawa_Tengah.shp'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `Jawa_Tengah' from data source </span></span>
<span><span class="co">#&gt;   `D:\Project\_2024\Bookdown Ekonometrika\ds-econometrics\Data\Bab6\peta jateng\Jawa_Tengah.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 35 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY, XYZ</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 108.5559 ymin: -8.211962 xmax: 111.6914 ymax: -5.725698</span></span>
<span><span class="co">#&gt; z_range:       zmin: 0 zmax: 0</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span></code></pre></div>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jateng2011</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">paneljateng</span>,<span class="op">(</span><span class="va">Tahun</span><span class="op">==</span><span class="fl">2011</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">jateng2011</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">jateng.map</span>, <span class="va">jateng2011</span>, by.x<span class="op">=</span><span class="st">"KABKOTNO"</span>, by.y<span class="op">=</span><span class="st">"NO"</span><span class="op">)</span></span>
<span><span class="va">jateng2011</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/valid.html">st_make_valid</a></span><span class="op">(</span><span class="va">jateng2011</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">jateng2011</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">PDRB</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Blues"</span><span class="op">)</span>,</span>
<span>                       values <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html">rescale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">jateng2011</span><span class="op">$</span><span class="va">PDRB</span><span class="op">)</span>, </span>
<span>                                                    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">jateng2011</span><span class="op">$</span><span class="va">PDRB</span><span class="op">)</span><span class="op">*</span><span class="fl">1.01</span>, </span>
<span>                                                    length <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"PDRB"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Bab6_files/figure-html/unnamed-chunk-15-1.png" width="672"></div>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">jateng2011</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">IPM</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Greens"</span><span class="op">)</span>,</span>
<span>                       values <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html">rescale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">jateng2011</span><span class="op">$</span><span class="va">IPM</span><span class="op">)</span>, </span>
<span>                                                    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">jateng2011</span><span class="op">$</span><span class="va">IPM</span><span class="op">)</span><span class="op">*</span><span class="fl">1.01</span>, </span>
<span>                                                    length <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"IPM"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Bab6_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
</div>
<div id="function-for-spatial-panel-evalutation" class="section level3" number="6.3.4">
<h3>
<span class="header-section-number">6.3.4</span> Function for Spatial Panel Evalutation<a class="anchor" aria-label="anchor" href="#function-for-spatial-panel-evalutation"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">godf.spml</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">k</span><span class="op">=</span><span class="fl">2</span>, <span class="va">criterion</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AIC"</span>, <span class="st">"BIC"</span><span class="op">)</span>,  <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">s</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span>  <span class="va">l</span><span class="op">&lt;-</span><span class="va">s</span><span class="op">$</span><span class="va">logLik</span></span>
<span>  <span class="va">np</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">N</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">criterion</span><span class="op">==</span><span class="st">"AIC"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">aic</span><span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">l</span><span class="op">+</span><span class="va">k</span><span class="op">*</span><span class="va">np</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">aic</span><span class="op">)</span><span class="op">&lt;-</span><span class="st">"AIC"</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">aic</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">criterion</span><span class="op">==</span><span class="st">"BIC"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">bic</span><span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">l</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">*</span><span class="va">np</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">bic</span><span class="op">)</span><span class="op">&lt;-</span><span class="st">"BIC"</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">k</span><span class="op">!=</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="st">"parameter &lt;k&gt; not used for BIC"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bic</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="spatial-panel-model-with-contiguity-weight-matrix" class="section level3" number="6.3.5">
<h3>
<span class="header-section-number">6.3.5</span> Spatial Panel Model with Contiguity Weight Matrix<a class="anchor" aria-label="anchor" href="#spatial-panel-model-with-contiguity-weight-matrix"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jateng.map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/valid.html">st_make_valid</a></span><span class="op">(</span><span class="va">jateng.map</span><span class="op">)</span></span>
<span><span class="va">listqueen</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="va">jateng.map</span>, queen<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">W.queen</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">listqueen</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span></span>
<span><span class="va">W.queen</span></span>
<span><span class="co">#&gt; Characteristics of weights list object:</span></span>
<span><span class="co">#&gt; Neighbour list object:</span></span>
<span><span class="co">#&gt; Number of regions: 35 </span></span>
<span><span class="co">#&gt; Number of nonzero links: 148 </span></span>
<span><span class="co">#&gt; Percentage nonzero weights: 12.08163 </span></span>
<span><span class="co">#&gt; Average number of links: 4.228571 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weights style: W </span></span>
<span><span class="co">#&gt; Weights constants summary:</span></span>
<span><span class="co">#&gt;    n   nn S0       S1       S2</span></span>
<span><span class="co">#&gt; W 35 1225 35 18.64242 151.0178</span></span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SAR Model</span></span>
<span><span class="va">sar.fem.contig</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/splm/man/spml.html">spml</a></span><span class="op">(</span><span class="va">modelpanel</span>, data<span class="op">=</span><span class="va">paneljateng</span>, listw<span class="op">=</span><span class="va">W.queen</span>, model<span class="op">=</span><span class="st">"within"</span>, lag<span class="op">=</span><span class="cn">TRUE</span>, spatial.error<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">sar.rem.contig</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/splm/man/spml.html">spml</a></span><span class="op">(</span><span class="va">modelpanel</span>, data<span class="op">=</span><span class="va">paneljateng</span>, listw<span class="op">=</span><span class="va">W.queen</span>, model<span class="op">=</span><span class="st">"random"</span>, lag<span class="op">=</span><span class="cn">TRUE</span>, spatial.error<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/splm/man/sphtest.html">sphtest</a></span><span class="op">(</span><span class="va">sar.fem.contig</span>, <span class="va">sar.rem.contig</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Hausman test for spatial models</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  modelpanel</span></span>
<span><span class="co">#&gt; chisq = 0.15855, df = 4, p-value = 0.997</span></span>
<span><span class="co">#&gt; alternative hypothesis: one model is inconsistent</span></span>
<span><span class="fu">godf.spml</span><span class="op">(</span><span class="va">sar.rem.contig</span>, criterion<span class="op">=</span><span class="st">"AIC"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       AIC </span></span>
<span><span class="co">#&gt; -703.0118</span></span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SEM Model</span></span>
<span><span class="va">sem.fem.contig</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/splm/man/spml.html">spml</a></span><span class="op">(</span><span class="va">modelpanel</span>, data<span class="op">=</span><span class="va">paneljateng</span>, listw<span class="op">=</span><span class="va">W.queen</span>, model<span class="op">=</span><span class="st">"within"</span>, lag<span class="op">=</span><span class="cn">FALSE</span>, spatial.error<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></span>
<span><span class="va">sem.rem.contig</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/splm/man/spml.html">spml</a></span><span class="op">(</span><span class="va">modelpanel</span>, data<span class="op">=</span><span class="va">paneljateng</span>, listw<span class="op">=</span><span class="va">W.queen</span>, model<span class="op">=</span><span class="st">"random"</span>, lag<span class="op">=</span><span class="cn">FALSE</span>, spatial.error<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/splm/man/sphtest.html">sphtest</a></span><span class="op">(</span><span class="va">sem.fem.contig</span>, <span class="va">sem.rem.contig</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Hausman test for spatial models</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  modelpanel</span></span>
<span><span class="co">#&gt; chisq = 5.4546, df = 4, p-value = 0.2438</span></span>
<span><span class="co">#&gt; alternative hypothesis: one model is inconsistent</span></span>
<span><span class="fu">godf.spml</span><span class="op">(</span><span class="va">sem.rem.contig</span>, criterion<span class="op">=</span><span class="st">"AIC"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       AIC </span></span>
<span><span class="co">#&gt; -633.5611</span></span></code></pre></div>
</div>
<div id="spatial-panel-model-with-knn-weight-matrix" class="section level3" number="6.3.6">
<h3>
<span class="header-section-number">6.3.6</span> Spatial Panel Model with KNN Weight Matrix<a class="anchor" aria-label="anchor" href="#spatial-panel-model-with-knn-weight-matrix"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># K-nearest neighbour with 5 neighbour </span></span>
<span><span class="va">centroids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_centroid</a></span><span class="op">(</span><span class="va">jateng.map</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: st_centroid assumes attributes are constant over</span></span>
<span><span class="co">#&gt; geometries</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">centroids</span><span class="op">)</span></span>
<span><span class="va">neighbour</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html">knearneigh</a></span><span class="op">(</span><span class="va">coords</span>, k<span class="op">=</span><span class="fl">5</span>, longlat<span class="op">=</span><span class="cn">T</span><span class="op">)</span> </span>
<span><span class="va">neighbourlist</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knn2nb.html">knn2nb</a></span><span class="op">(</span><span class="va">neighbour</span><span class="op">)</span>                              </span>
<span><span class="va">mat.knn5</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html">nb2mat</a></span><span class="op">(</span><span class="va">neighbourlist</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span>                     </span>
<span><span class="va">W.knn5</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">neighbourlist</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span></span>
<span><span class="va">W.knn5</span></span>
<span><span class="co">#&gt; Characteristics of weights list object:</span></span>
<span><span class="co">#&gt; Neighbour list object:</span></span>
<span><span class="co">#&gt; Number of regions: 35 </span></span>
<span><span class="co">#&gt; Number of nonzero links: 175 </span></span>
<span><span class="co">#&gt; Percentage nonzero weights: 14.28571 </span></span>
<span><span class="co">#&gt; Average number of links: 5 </span></span>
<span><span class="co">#&gt; Non-symmetric neighbours list</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weights style: W </span></span>
<span><span class="co">#&gt; Weights constants summary:</span></span>
<span><span class="co">#&gt;    n   nn S0    S1     S2</span></span>
<span><span class="co">#&gt; W 35 1225 35 12.44 144.48</span></span></code></pre></div>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SAR Model</span></span>
<span><span class="va">sar.fem.5nn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/splm/man/spml.html">spml</a></span><span class="op">(</span><span class="va">modelpanel</span>, data<span class="op">=</span><span class="va">paneljateng</span>, listw<span class="op">=</span><span class="va">W.knn5</span>, model<span class="op">=</span><span class="st">"within"</span>, lag<span class="op">=</span><span class="cn">TRUE</span>, spatial.error<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">sar.rem.5nn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/splm/man/spml.html">spml</a></span><span class="op">(</span><span class="va">modelpanel</span>, data<span class="op">=</span><span class="va">paneljateng</span>, listw<span class="op">=</span><span class="va">W.knn5</span>, model<span class="op">=</span><span class="st">"random"</span>, lag<span class="op">=</span><span class="cn">TRUE</span>, spatial.error<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/splm/man/sphtest.html">sphtest</a></span><span class="op">(</span><span class="va">sar.fem.5nn</span>, <span class="va">sar.rem.5nn</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Hausman test for spatial models</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  modelpanel</span></span>
<span><span class="co">#&gt; chisq = 0.9208, df = 4, p-value = 0.9216</span></span>
<span><span class="co">#&gt; alternative hypothesis: one model is inconsistent</span></span>
<span><span class="fu">godf.spml</span><span class="op">(</span><span class="va">sar.rem.5nn</span>, criterion<span class="op">=</span><span class="st">"AIC"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       AIC </span></span>
<span><span class="co">#&gt; -717.8954</span></span>
<span></span>
<span><span class="co"># SEM Model</span></span>
<span><span class="va">sem.fem.5nn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/splm/man/spml.html">spml</a></span><span class="op">(</span><span class="va">modelpanel</span>, data<span class="op">=</span><span class="va">paneljateng</span>, listw<span class="op">=</span><span class="va">W.knn5</span>, model<span class="op">=</span><span class="st">"within"</span>, lag<span class="op">=</span><span class="cn">FALSE</span>, spatial.error<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></span>
<span><span class="va">sem.rem.5nn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/splm/man/spml.html">spml</a></span><span class="op">(</span><span class="va">modelpanel</span>, data<span class="op">=</span><span class="va">paneljateng</span>, listw<span class="op">=</span><span class="va">W.knn5</span>, model<span class="op">=</span><span class="st">"random"</span>, lag<span class="op">=</span><span class="cn">FALSE</span>, spatial.error<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/splm/man/sphtest.html">sphtest</a></span><span class="op">(</span><span class="va">sem.fem.5nn</span>, <span class="va">sem.rem.5nn</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Hausman test for spatial models</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  modelpanel</span></span>
<span><span class="co">#&gt; chisq = 5.3246, df = 4, p-value = 0.2556</span></span>
<span><span class="co">#&gt; alternative hypothesis: one model is inconsistent</span></span>
<span><span class="fu">godf.spml</span><span class="op">(</span><span class="va">sem.rem.5nn</span>, criterion<span class="op">=</span><span class="st">"AIC"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       AIC </span></span>
<span><span class="co">#&gt; -636.4432</span></span></code></pre></div>
</div>
<div id="best-model" class="section level3" number="6.3.7">
<h3>
<span class="header-section-number">6.3.7</span> Best Model<a class="anchor" aria-label="anchor" href="#best-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">sar.rem.5nn</span><span class="op">)</span></span>
<span><span class="co">#&gt; ML panel with spatial lag, random effects </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; spreml(formula = formula, data = data, index = index, w = listw2mat(listw), </span></span>
<span><span class="co">#&gt;     w2 = listw2mat(listw2), lag = lag, errors = errors, cl = cl)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    11.2    12.1    12.4    12.4    12.7    14.2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Error variance parameters:</span></span>
<span><span class="co">#&gt;     Estimate Std. Error t-value  Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; phi   4204.2     1174.1  3.5808 0.0003425 ***</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spatial autoregressive coefficient:</span></span>
<span><span class="co">#&gt;        Estimate Std. Error t-value  Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; lambda 0.750456   0.053411   14.05 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t-value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept) 1.2042585  0.7177210  1.6779 0.093368 . </span></span>
<span><span class="co">#&gt; log(AK)     0.0474276  0.0241591  1.9631 0.049630 * </span></span>
<span><span class="co">#&gt; log(PAD)    0.0134898  0.0063019  2.1406 0.032306 * </span></span>
<span><span class="co">#&gt; log(UMK)    0.0470068  0.0167872  2.8002 0.005108 **</span></span>
<span><span class="co">#&gt; log(IPM)    0.3633197  0.1772088  2.0502 0.040342 * </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div id="impacts-spillovr---only-for-sar-model" class="section level3" number="6.3.8">
<h3>
<span class="header-section-number">6.3.8</span> Impacts (Spillovr) - Only for SAR Model<a class="anchor" aria-label="anchor" href="#impacts-spillovr---only-for-sar-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Direct and Indirect Effect</span></span>
<span><span class="va">time</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">paneljateng</span><span class="op">$</span><span class="va">Tahun</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sW.5knn</span> <span class="op">=</span> <span class="fu">kronecker</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Diagonal.html">Diagonal</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/splm/man/listw2dgCMatrix.html">listw2dgCMatrix</a></span><span class="op">(</span><span class="va">W.knn5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">trMatc</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spatialreg/reference/trW.html">trW</a></span><span class="op">(</span><span class="va">sW.5knn</span>, type<span class="op">=</span><span class="st">"mult"</span><span class="op">)</span></span>
<span><span class="va">imp</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spatialreg/reference/impacts.html">impacts</a></span><span class="op">(</span><span class="va">sar.rem.5nn</span>, tr <span class="op">=</span> <span class="va">trMatc</span>, R <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">imp</span>, zstats<span class="op">=</span><span class="cn">TRUE</span>, short<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; Impact measures (lag, trace):</span></span>
<span><span class="co">#&gt;              Direct  Indirect      Total</span></span>
<span><span class="co">#&gt; log(AK)  0.05723256 0.1327900 0.19002256</span></span>
<span><span class="co">#&gt; log(PAD) 0.01627868 0.0377695 0.05404818</span></span>
<span><span class="co">#&gt; log(UMK) 0.05672481 0.1316119 0.18833673</span></span>
<span><span class="co">#&gt; log(IPM) 0.43843073 1.0172393 1.45567007</span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; Simulation results ( variance matrix):</span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; Simulated standard errors</span></span>
<span><span class="co">#&gt;              Direct   Indirect      Total</span></span>
<span><span class="co">#&gt; log(AK)  0.02901319 0.08363074 0.10973883</span></span>
<span><span class="co">#&gt; log(PAD) 0.00734999 0.02062104 0.02706686</span></span>
<span><span class="co">#&gt; log(UMK) 0.02147235 0.08000097 0.09848155</span></span>
<span><span class="co">#&gt; log(IPM) 0.22893212 0.65960697 0.86733379</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulated z-values:</span></span>
<span><span class="co">#&gt;            Direct Indirect    Total</span></span>
<span><span class="co">#&gt; log(AK)  1.994006 1.693123 1.817494</span></span>
<span><span class="co">#&gt; log(PAD) 2.422577 2.079525 2.242148</span></span>
<span><span class="co">#&gt; log(UMK) 2.675301 1.800563 2.045985</span></span>
<span><span class="co">#&gt; log(IPM) 1.772328 1.503276 1.611045</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulated p-values:</span></span>
<span><span class="co">#&gt;          Direct    Indirect Total   </span></span>
<span><span class="co">#&gt; log(AK)  0.0461514 0.090432 0.069142</span></span>
<span><span class="co">#&gt; log(PAD) 0.0154108 0.037569 0.024952</span></span>
<span><span class="co">#&gt; log(UMK) 0.0074662 0.071772 0.040758</span></span>
<span><span class="co">#&gt; log(IPM) 0.0763402 0.132768 0.107170</span></span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="panel-data-regression.html"><span class="header-section-number">5</span> Panel Data Regression</a></div>
<div class="next"><a href="time-series-spillover---gvar.html"><span class="header-section-number">7</span> Time Series Spillover - GVAR</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#spatial-regression"><span class="header-section-number">6</span> Spatial Regression</a></li>
<li><a class="nav-link" href="#library"><span class="header-section-number">6.1</span> Library</a></li>
<li>
<a class="nav-link" href="#cross-section"><span class="header-section-number">6.2</span> Cross-Section</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ols-model"><span class="header-section-number">6.2.1</span> OLS Model</a></li>
<li><a class="nav-link" href="#weight-matrix"><span class="header-section-number">6.2.2</span> Weight Matrix</a></li>
<li><a class="nav-link" href="#moran-test-and-plot"><span class="header-section-number">6.2.3</span> Moran Test and Plot</a></li>
<li><a class="nav-link" href="#lm-test"><span class="header-section-number">6.2.4</span> LM Test</a></li>
<li><a class="nav-link" href="#sar-model"><span class="header-section-number">6.2.5</span> SAR Model</a></li>
<li><a class="nav-link" href="#impacts-spillover"><span class="header-section-number">6.2.6</span> Impacts (Spillover)</a></li>
<li><a class="nav-link" href="#sem-model"><span class="header-section-number">6.2.7</span> SEM Model</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#spatial-panel"><span class="header-section-number">6.3</span> Spatial Panel</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#static-panel-regression"><span class="header-section-number">6.3.1</span> Static Panel Regression</a></li>
<li><a class="nav-link" href="#depndency-test"><span class="header-section-number">6.3.2</span> Depndency Test</a></li>
<li><a class="nav-link" href="#maps-visualization"><span class="header-section-number">6.3.3</span> Maps Visualization</a></li>
<li><a class="nav-link" href="#function-for-spatial-panel-evalutation"><span class="header-section-number">6.3.4</span> Function for Spatial Panel Evalutation</a></li>
<li><a class="nav-link" href="#spatial-panel-model-with-contiguity-weight-matrix"><span class="header-section-number">6.3.5</span> Spatial Panel Model with Contiguity Weight Matrix</a></li>
<li><a class="nav-link" href="#spatial-panel-model-with-knn-weight-matrix"><span class="header-section-number">6.3.6</span> Spatial Panel Model with KNN Weight Matrix</a></li>
<li><a class="nav-link" href="#best-model"><span class="header-section-number">6.3.7</span> Best Model</a></li>
<li><a class="nav-link" href="#impacts-spillovr---only-for-sar-model"><span class="header-section-number">6.3.8</span> Impacts (Spillovr) - Only for SAR Model</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/dekayzds/ds-econometrics/blob/master/06-Bab6.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/dekayzds/ds-econometrics/edit/master/06-Bab6.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Application of Econometric Models with RStudio</strong>" was written by Deri Siswara. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>

{
  "hash": "296b14efd10560a738a338e068a732bc",
  "result": {
    "engine": "knitr",
    "markdown": "# Spatial Regression\n## Library\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"spdep\")\n# install.packages(\"spatialreg\")\n# install.packages(\"RColorBrewer\")\n# install.packages(\"splm\")\n# install.packages(\"sf\")\n# install.packages(\"ggplot2\")\nlibrary(spdep)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'spdep' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: spData\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'spData' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTo access larger datasets in this package, install the spDataLarge\npackage with: `install.packages('spDataLarge',\nrepos='https://nowosad.github.io/drat/', type='source')`\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: sf\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'sf' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(spatialreg)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'spatialreg' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: Matrix\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'spatialreg'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:spdep':\n\n    get.ClusterOption, get.coresOption, get.mcOption,\n    get.VerboseOption, get.ZeroPolicyOption, set.ClusterOption,\n    set.coresOption, set.mcOption, set.VerboseOption,\n    set.ZeroPolicyOption\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\nlibrary(splm)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'splm' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(sf)\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggplot2' was built under R version 4.4.3\n```\n\n\n:::\n:::\n\n## Cross-Section\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nprovinsi <- read_excel(\"Data/Bab6/provinsi Indonesia.xlsx\")\nhead(provinsi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n  province    pdrb investment infra revenue\n  <chr>      <dbl>      <dbl> <dbl>   <dbl>\n1 Aceh     129093.      4485.  0.37  11694.\n2 Sumut    571722.     21477.  0.52   8481.\n3 Sumbar   179952.      2340.  0.52   4052.\n4 Riau     652762.     18957.  0.28   6911.\n5 Jambi    155066.      5026.  0.26   3130.\n6 Sumsel   331766.     19853.  0.2    5990.\n```\n\n\n:::\n:::\n\n### OLS Model\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 = log(pdrb) ~ log(investment) + log(infra) + log(revenue)\nols = lm(model1, data=provinsi)\nsummary(ols)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = model1, data = provinsi)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.82306 -0.33812  0.00604  0.32399  0.83581 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      3.95883    0.85379   4.637 6.48e-05 ***\nlog(investment)  0.42187    0.08375   5.037 2.10e-05 ***\nlog(infra)       0.24988    0.07807   3.201  0.00323 ** \nlog(revenue)     0.53807    0.15207   3.538  0.00133 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4094 on 30 degrees of freedom\nMultiple R-squared:  0.8883,\tAdjusted R-squared:  0.8771 \nF-statistic: 79.53 on 3 and 30 DF,  p-value: 2.226e-14\n```\n\n\n:::\n:::\n\n\n### Weight Matrix\n\n::: {.cell}\n\n```{.r .cell-code}\nmigrasi <- read_excel(\"Data/Bab6/matriks migrasi.xlsx\", sheet = 2, col_names = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\n• `` -> `...1`\n• `` -> `...2`\n• `` -> `...3`\n• `` -> `...4`\n• `` -> `...5`\n• `` -> `...6`\n• `` -> `...7`\n• `` -> `...8`\n• `` -> `...9`\n• `` -> `...10`\n• `` -> `...11`\n• `` -> `...12`\n• `` -> `...13`\n• `` -> `...14`\n• `` -> `...15`\n• `` -> `...16`\n• `` -> `...17`\n• `` -> `...18`\n• `` -> `...19`\n• `` -> `...20`\n• `` -> `...21`\n• `` -> `...22`\n• `` -> `...23`\n• `` -> `...24`\n• `` -> `...25`\n• `` -> `...26`\n• `` -> `...27`\n• `` -> `...28`\n• `` -> `...29`\n• `` -> `...30`\n• `` -> `...31`\n• `` -> `...32`\n• `` -> `...33`\n• `` -> `...34`\n```\n\n\n:::\n\n```{.r .cell-code}\nmigrasi = as.matrix(migrasi)\nW.migrasi = mat2listw(migrasi)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in mat2listw(migrasi): style is M (missing); style should be set to a\nvalid value\n```\n\n\n:::\n:::\n\n\n### Moran Test and Plot\n\n::: {.cell}\n\n```{.r .cell-code}\nmoran.lm = lm.morantest(ols, W.migrasi)\nmoran.lm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tGlobal Moran I for regression residuals\n\ndata:  \nmodel: lm(formula = model1, data = provinsi)\nweights: W.migrasi\n\nMoran I statistic standard deviate = 3.4669, p-value = 0.0002632\nalternative hypothesis: greater\nsample estimates:\nObserved Moran I      Expectation         Variance \n     0.213239417     -0.048308437      0.005691365 \n```\n\n\n:::\n\n```{.r .cell-code}\nmoran.plot(ols$residuals, W.migrasi)\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### LM Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nLM = lm.LMtests(ols, W.migrasi, test=\"all\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPlease update scripts to use lm.RStests in place of lm.LMtests\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in lm.RStests(model = model, listw = listw, zero.policy = zero.policy,\n: Spatial weights matrix not row standardized\n```\n\n\n:::\n\n```{.r .cell-code}\nLM\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n\tdependence\n\ndata:  \nmodel: lm(formula = model1, data = provinsi)\ntest weights: listw\n\nRSerr = 5.4456, df = 1, p-value = 0.01962\n\n\n\tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n\tdependence\n\ndata:  \nmodel: lm(formula = model1, data = provinsi)\ntest weights: listw\n\nRSlag = 3.2163, df = 1, p-value = 0.07291\n\n\n\tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n\tdependence\n\ndata:  \nmodel: lm(formula = model1, data = provinsi)\ntest weights: listw\n\nadjRSerr = 3.0702, df = 1, p-value = 0.07974\n\n\n\tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n\tdependence\n\ndata:  \nmodel: lm(formula = model1, data = provinsi)\ntest weights: listw\n\nadjRSlag = 0.84087, df = 1, p-value = 0.3591\n\n\n\tRao's score (a.k.a Lagrange multiplier) diagnostics for spatial\n\tdependence\n\ndata:  \nmodel: lm(formula = model1, data = provinsi)\ntest weights: listw\n\nSARMA = 6.2865, df = 2, p-value = 0.04314\n```\n\n\n:::\n:::\n\n\n### SAR Model\n\n::: {.cell}\n\n```{.r .cell-code}\nsar.provinsi = lagsarlm(model1, data=provinsi, W.migrasi)\nsummary(sar.provinsi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:lagsarlm(formula = model1, data = provinsi, listw = W.migrasi)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.679482 -0.291161 -0.083437  0.336403  0.808845 \n\nType: lag \nCoefficients: (asymptotic standard errors) \n                Estimate Std. Error z value  Pr(>|z|)\n(Intercept)     1.744150   1.437574  1.2133 0.2250310\nlog(investment) 0.380784   0.079364  4.7979 1.603e-06\nlog(infra)      0.207431   0.073675  2.8155 0.0048701\nlog(revenue)    0.529174   0.136397  3.8797 0.0001046\n\nRho: 0.21114, LR test value: 3.0033, p-value: 0.083096\nAsymptotic standard error: 0.12002\n    z-value: 1.7592, p-value: 0.07854\nWald statistic: 3.0949, p-value: 0.07854\n\nLog likelihood: -14.24739 for lag model\nML residual variance (sigma squared): 0.13454, (sigma: 0.36679)\nNumber of observations: 34 \nNumber of parameters estimated: 6 \nAIC: 40.495, (AIC for lm: 41.498)\nLM test for residual autocorrelation\ntest value: 2.5558, p-value: 0.10989\n```\n\n\n:::\n:::\n\n\n### Impacts (Spillover)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimpacts(sar.provinsi, listw=W.migrasi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nImpact measures (lag, exact):\n                   Direct   Indirect     Total\nlog(investment) 0.3831961 0.09950271 0.4826988\nlog(infra)      0.2087457 0.05420401 0.2629497\nlog(revenue)    0.5325268 0.13827873 0.6708055\n```\n\n\n:::\n:::\n\n\n### SEM Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsem.provinsi = errorsarlm(model1, data=provinsi, W.migrasi)\nsummary(sem.provinsi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:errorsarlm(formula = model1, data = provinsi, listw = W.migrasi)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.770148 -0.273480 -0.020662  0.325690  0.647156 \n\nType: error \nCoefficients: (asymptotic standard errors) \n                Estimate Std. Error z value  Pr(>|z|)\n(Intercept)     3.831947   0.772493  4.9605 7.031e-07\nlog(investment) 0.410266   0.072801  5.6354 1.746e-08\nlog(infra)      0.209178   0.071237  2.9364  0.003321\nlog(revenue)    0.550807   0.132071  4.1705 3.039e-05\n\nLambda: 0.60794, LR test value: 5.1345, p-value: 0.023455\nAsymptotic standard error: 0.19219\n    z-value: 3.1632, p-value: 0.0015604\nWald statistic: 10.006, p-value: 0.0015604\n\nLog likelihood: -13.18178 for error model\nML residual variance (sigma squared): 0.11956, (sigma: 0.34577)\nNumber of observations: 34 \nNumber of parameters estimated: 6 \nAIC: 38.364, (AIC for lm: 41.498)\n```\n\n\n:::\n:::\n\n\n## Spatial Panel\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\npaneljateng <- read_excel(\"Data/Bab6/panel jateng.xlsx\")\nhead(paneljateng)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 8\n  Region        Tahun      PDRB     AK     PAD      UMK   IPM NO   \n  <chr>         <dbl>     <dbl>  <dbl>   <dbl>    <dbl> <dbl> <chr>\n1 Kab. Cilacap   2011 78156819. 797518 173141.  718667.  64.7 01   \n2 Kab. Cilacap   2012 79702238. 716465 196673.  773000   65.7 01   \n3 Kab. Cilacap   2013 81022670. 729059 278508.  887667   66.8 01   \n4 Kab. Cilacap   2014 83392999. 736247 373907. 1016667.  67.2 01   \n5 Kab. Cilacap   2015 88777805. 715819 409846. 1195667.  67.8 01   \n6 Kab. Banyumas  2011 24538596. 761034 193263.  750000   67.4 02   \n```\n\n\n:::\n:::\n\n\n### Static Panel Regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plm)\nmodelpanel = log(PDRB) ~ log(AK) + log(PAD) + log(UMK) + log(IPM)\nfem1 = plm(modelpanel, data=paneljateng, index=c(\"Region\", \"Tahun\"), model=\"within\")\nrem1 = plm(modelpanel, data=paneljateng, index=c(\"Region\", \"Tahun\"), model=\"random\")\nphtest(fem1, rem1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tHausman Test\n\ndata:  modelpanel\nchisq = 37.156, df = 4, p-value = 1.673e-07\nalternative hypothesis: one model is inconsistent\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lmtest)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: zoo\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'zoo'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n\n\n:::\n\n```{.r .cell-code}\nbptest(fem1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tstudentized Breusch-Pagan test\n\ndata:  fem1\nBP = 5.8081, df = 4, p-value = 0.2139\n```\n\n\n:::\n\n```{.r .cell-code}\npbgtest(fem1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBreusch-Godfrey/Wooldridge test for serial correlation in panel models\n\ndata:  modelpanel\nchisq = 51.619, df = 5, p-value = 6.458e-10\nalternative hypothesis: serial correlation in idiosyncratic errors\n```\n\n\n:::\n:::\n\n\n### Depndency Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\npcdtest(fem1, test=\"lm\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBreusch-Pagan LM test for cross-sectional dependence in panels\n\ndata:  log(PDRB) ~ log(AK) + log(PAD) + log(UMK) + log(IPM)\nchisq = 1268.3, df = 595, p-value < 2.2e-16\nalternative hypothesis: cross-sectional dependence\n```\n\n\n:::\n\n```{.r .cell-code}\npcdtest(fem1, test=\"cd\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPesaran CD test for cross-sectional dependence in panels\n\ndata:  log(PDRB) ~ log(AK) + log(PAD) + log(UMK) + log(IPM)\nz = 12.724, p-value < 2.2e-16\nalternative hypothesis: cross-sectional dependence\n```\n\n\n:::\n:::\n\n\n### Maps Visualization \n\n::: {.cell}\n\n```{.r .cell-code}\njateng.map = st_read('Data/Bab6/peta jateng/Jawa_Tengah.shp')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `Jawa_Tengah' from data source \n  `D:\\Dokumentasi\\econometricsbook\\Data\\Bab6\\peta jateng\\Jawa_Tengah.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 35 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 108.5559 ymin: -8.211962 xmax: 111.6914 ymax: -5.725698\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\njateng2011 = subset(paneljateng,(Tahun==2011))\njateng2011 = merge(jateng.map, jateng2011, by.x=\"KABKOTNO\", by.y=\"NO\")\njateng2011 <- st_make_valid(jateng2011)\nggplot(jateng2011) +\n  geom_sf(aes(fill = PDRB)) +\n  scale_fill_gradientn(colours = brewer.pal(5, \"Blues\"),\n                       values = scales::rescale(seq(min(jateng2011$PDRB), \n                                                    max(jateng2011$PDRB)*1.01, \n                                                    length = 6))) +\n  theme_minimal() +\n  labs(fill = \"PDRB\")\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(jateng2011) +\n  geom_sf(aes(fill = IPM)) +\n  scale_fill_gradientn(colours = brewer.pal(5, \"Greens\"),\n                       values = scales::rescale(seq(min(jateng2011$IPM), \n                                                    max(jateng2011$IPM)*1.01, \n                                                    length = 6))) +\n  theme_minimal() +\n  labs(fill = \"IPM\")\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n### Function for Spatial Panel Evalutation\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngodf.spml<-function(object, k=2, criterion=c(\"AIC\", \"BIC\"),  ...){\n  s<-summary(object)\n  l<-s$logLik\n  np<- length(coef(s))\n  N<- nrow(s$model)\n  if(criterion==\"AIC\"){\n    aic<- -2*l+k*np\n    names(aic)<-\"AIC\"\n    return(aic)\n  }\n  if(criterion==\"BIC\"){\n    bic<- -2*l+log(N)*np\n    names(bic)<-\"BIC\"\n    if(k!=2){\n      warning(\"parameter <k> not used for BIC\")\n    }\n    return(bic)\n  }\n}\n```\n:::\n\n\n### Spatial Panel Model with Contiguity Weight Matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\njateng.map <- st_make_valid(jateng.map)\nlistqueen = poly2nb(jateng.map, queen=TRUE)\nW.queen = nb2listw(listqueen, style=\"W\")\nW.queen\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 35 \nNumber of nonzero links: 148 \nPercentage nonzero weights: 12.08163 \nAverage number of links: 4.228571 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 35 1225 35 18.64242 151.0178\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SAR Model\nsar.fem.contig = spml(modelpanel, data=paneljateng, listw=W.queen, model=\"within\", lag=TRUE, spatial.error=\"none\")\nsar.rem.contig = spml(modelpanel, data=paneljateng, listw=W.queen, model=\"random\", lag=TRUE, spatial.error=\"none\")\nsphtest(sar.fem.contig, sar.rem.contig)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tHausman test for spatial models\n\ndata:  modelpanel\nchisq = 0.15855, df = 4, p-value = 0.997\nalternative hypothesis: one model is inconsistent\n```\n\n\n:::\n\n```{.r .cell-code}\ngodf.spml(sar.rem.contig, criterion=\"AIC\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      AIC \n-703.0118 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SEM Model\nsem.fem.contig = spml(modelpanel, data=paneljateng, listw=W.queen, model=\"within\", lag=FALSE, spatial.error=\"b\")\nsem.rem.contig = spml(modelpanel, data=paneljateng, listw=W.queen, model=\"random\", lag=FALSE, spatial.error=\"b\")\nsphtest(sem.fem.contig, sem.rem.contig)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tHausman test for spatial models\n\ndata:  modelpanel\nchisq = 5.4546, df = 4, p-value = 0.2438\nalternative hypothesis: one model is inconsistent\n```\n\n\n:::\n\n```{.r .cell-code}\ngodf.spml(sem.rem.contig, criterion=\"AIC\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      AIC \n-633.5611 \n```\n\n\n:::\n:::\n\n\n\n### Spatial Panel Model with KNN Weight Matrix\n\n::: {.cell}\n\n```{.r .cell-code}\n# K-nearest neighbour with 5 neighbour \ncentroids <- st_centroid(jateng.map)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: st_centroid assumes attributes are constant over geometries\n```\n\n\n:::\n\n```{.r .cell-code}\ncoords <- st_coordinates(centroids)\nneighbour = knearneigh(coords, k=5, longlat=T) \nneighbourlist = knn2nb(neighbour)                              \nmat.knn5 = nb2mat(neighbourlist, style=\"W\")                     \nW.knn5 = nb2listw(neighbourlist, style=\"W\")\nW.knn5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 35 \nNumber of nonzero links: 175 \nPercentage nonzero weights: 14.28571 \nAverage number of links: 5 \nNon-symmetric neighbours list\n\nWeights style: W \nWeights constants summary:\n   n   nn S0    S1     S2\nW 35 1225 35 12.44 144.48\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SAR Model\nsar.fem.5nn = spml(modelpanel, data=paneljateng, listw=W.knn5, model=\"within\", lag=TRUE, spatial.error=\"none\")\nsar.rem.5nn = spml(modelpanel, data=paneljateng, listw=W.knn5, model=\"random\", lag=TRUE, spatial.error=\"none\")\nsphtest(sar.fem.5nn, sar.rem.5nn)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tHausman test for spatial models\n\ndata:  modelpanel\nchisq = 0.9208, df = 4, p-value = 0.9216\nalternative hypothesis: one model is inconsistent\n```\n\n\n:::\n\n```{.r .cell-code}\ngodf.spml(sar.rem.5nn, criterion=\"AIC\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      AIC \n-717.8954 \n```\n\n\n:::\n\n```{.r .cell-code}\n# SEM Model\nsem.fem.5nn = spml(modelpanel, data=paneljateng, listw=W.knn5, model=\"within\", lag=FALSE, spatial.error=\"b\")\nsem.rem.5nn = spml(modelpanel, data=paneljateng, listw=W.knn5, model=\"random\", lag=FALSE, spatial.error=\"b\")\nsphtest(sem.fem.5nn, sem.rem.5nn)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tHausman test for spatial models\n\ndata:  modelpanel\nchisq = 5.3246, df = 4, p-value = 0.2556\nalternative hypothesis: one model is inconsistent\n```\n\n\n:::\n\n```{.r .cell-code}\ngodf.spml(sem.rem.5nn, criterion=\"AIC\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      AIC \n-636.4432 \n```\n\n\n:::\n:::\n\n\n### Best Model\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(sar.rem.5nn)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nML panel with spatial lag, random effects \n\nCall:\nspreml(formula = formula, data = data, index = index, w = listw2mat(listw), \n    w2 = listw2mat(listw2), lag = lag, errors = errors, cl = cl)\n\nResiduals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   11.2    12.1    12.4    12.4    12.7    14.2 \n\nError variance parameters:\n    Estimate Std. Error t-value  Pr(>|t|)    \nphi   4204.2     1172.1  3.5868 0.0003348 ***\n\nSpatial autoregressive coefficient:\n       Estimate Std. Error t-value  Pr(>|t|)    \nlambda 0.750456   0.053423  14.047 < 2.2e-16 ***\n\nCoefficients:\n             Estimate Std. Error t-value Pr(>|t|)   \n(Intercept) 1.2042585  0.7177210  1.6779 0.093368 . \nlog(AK)     0.0474276  0.0241591  1.9631 0.049630 * \nlog(PAD)    0.0134898  0.0063019  2.1406 0.032306 * \nlog(UMK)    0.0470068  0.0167872  2.8002 0.005108 **\nlog(IPM)    0.3633197  0.1772088  2.0502 0.040342 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n### Impacts (Spillovr) - Only for SAR Model\n\n::: {.cell}\n\n```{.r .cell-code}\n# Direct and Indirect Effect\ntime = length(unique(paneljateng$Tahun))\nsW.5knn = kronecker(Diagonal(time), listw2dgCMatrix(W.knn5))\nset.seed(12345)\ntrMatc = trW(sW.5knn, type=\"mult\")\nimp = impacts(sar.rem.5nn, tr = trMatc, R = 200)\nsummary(imp, zstats=TRUE, short=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nImpact measures (lag, trace):\n             Direct  Indirect      Total\nlog(AK)  0.05723256 0.1327900 0.19002256\nlog(PAD) 0.01627868 0.0377695 0.05404818\nlog(UMK) 0.05672481 0.1316119 0.18833673\nlog(IPM) 0.43843072 1.0172393 1.45567006\n========================================================\nSimulation results ( variance matrix):\n========================================================\nSimulated standard errors\n              Direct   Indirect      Total\nlog(AK)  0.029013340 0.08364084 0.10974771\nlog(PAD) 0.007350001 0.02062333 0.02706877\nlog(UMK) 0.021472770 0.08001914 0.09849884\nlog(IPM) 0.228933484 0.65969232 0.86740920\n\nSimulated z-values:\n           Direct Indirect    Total\nlog(AK)  1.994004 1.692971 1.817389\nlog(PAD) 2.422582 2.079346 2.242031\nlog(UMK) 2.675263 1.800226 2.045687\nlog(IPM) 1.772324 1.503129 1.610943\n\nSimulated p-values:\n         Direct    Indirect Total   \nlog(AK)  0.0461516 0.090461 0.069158\nlog(PAD) 0.0154107 0.037586 0.024959\nlog(UMK) 0.0074671 0.071825 0.040787\nlog(IPM) 0.0763407 0.132806 0.107192\n```\n\n\n:::\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}